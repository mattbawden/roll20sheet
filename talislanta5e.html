<div class="grid biggap">

    <img src="https://raw.githubusercontent.com/mattbawden/roll20sheet/main/talislantalogo.png" />

    <div class="grid col2-roll">
        <div class="grid col4-name">
            <label>Name</label>
            <input type="text" name="attr_charactername" value="" />
            <label>Race</label>
            <input type="text" name="attr_characterrace" value="" />
            <label>Gender</label>
            <input type="text" name="attr_charactergender" value="" />
            <label>Order</label>
            <select name="attr_characterorder">
                <option value="">Choose</option>
                <option value="astromancy">Astromancy</option>
                <option value="cartomancy">Cartomancy</option>
                <option value="cryptomancy">Cryptomancy</option>
                <option value="crystalomancy">Crystalomancy</option>
                <option value="elementalmagic">Elemental Magic</option>
                <option value="invocation">Invocation</option>
                <option value="mysticism">Mysticism</option>
                <option value="naturalmagic">Natural Magic</option>
                <option value="necromancy">Necromancy</option>
                <option value="shamanism">Shamanism</option>
                <option value="witchcraft">Witchcraft</option>
                <option value="wizardry">Wizardry</option>
            </select>
        </div>
    </div>

    <div class="grid col2">
        <div class="grid col1">
            <h2>Attributes</h2>
            <div class="grid col2-stats">
                <div class="flex">
                    <label>INT</label>
                    <input type="number" name="attr_intelligence" value="0" />
                    <button type="roll" name="roll_intelligence" value="&{template:default} {{name=Attribute | Intelligence}} {{Check Result=[[1d20 + (@{Intelligence}*2) [Attribute] + ?{Modifiers? Multiple Actions(-5)?|0} [Modifiers] - ?{DoD|0} [DoD]]]}} {{--------=--------}} {{Critical=20+}} {{Full=11-19}} {{Partial=6-10}} {{Failure=1-5}} {{Mishap=0 or below}}" />
                </div>

                <div class="flex">
                    <label>PER</label>
                    <input type="number" name="attr_perception" value="0" />
                    <button type="roll" name="roll_perception" value="&{template:default} {{name=Attribute | Perception}} {{Check Result=[[1d20 + (@{Perception}*2) [Attribute] + ?{Modifiers? Multiple Actions(-5)?|0} [Modifiers] - ?{DoD|0} [DoD]]]}} {{--------=--------}} {{Critical=20+}} {{Full=11-19}} {{Partial=6-10}} {{Failure=1-5}} {{Mishap=0 or below}}" />
                </div>

                <div class="flex">
                    <label>WIL</label>
                    <input type="number" name="attr_will" value="0" />
                    <button type="roll" name="roll_will" value="&{template:default} {{name=Attribute | Will}} {{Check Result=[[1d20 + (@{Will}*2) [Attribute] + ?{Modifiers? Multiple Actions(-5)?|0} [Modifiers] - ?{DoD|0} [DoD]]]}} {{--------=--------}} {{Critical=20+}} {{Full=11-19}} {{Partial=6-10}} {{Failure=1-5}} {{Mishap=0 or below}}" />
                </div>
                
                <div class="flex">
                    <label>CHA</label>
                    <input type="number" name="attr_charisma" value="0" />
                    <button type="roll" name="roll_charisma" value="&{template:default} {{name=Attribute | Charisma}} {{Check Result=[[1d20 + (@{Charisma}*2) [Attribute] + ?{Modifiers? Multiple Actions(-5)?|0} [Modifiers] - ?{DoD|0} [DoD]]]}} {{--------=--------}} {{Critical=20+}} {{Full=11-19}} {{Partial=6-10}} {{Failure=1-5}} {{Mishap=0 or below}}" />
                </div>

                <div class="flex">
                    <label>STR</label>
                    <input type="number" name="attr_strength" value="0" />
                    <button type="roll" name="roll_strength" value="&{template:default} {{name=Attribute | Strength}} {{Check Result=[[1d20 + (@{Strength}*2) [Attribute] + ?{Modifiers? Multiple Actions(-5)?|0} [Modifiers] - ?{DoD|0} [DoD]]]}} {{--------=--------}} {{Critical=20+}} {{Full=11-19}} {{Partial=6-10}} {{Failure=1-5}} {{Mishap=0 or below}}" />
                </div>

                <div class="flex">
                    <label>DEX</label>
                    <input type="number" name="attr_dexterity" value="0" />
                    <button type="roll" name="roll_dexterity" value="&{template:default} {{name=Attribute | Dexterity}} {{Check Result=[[1d20 + (@{Dexterity}*2) [Attribute] + ?{Modifiers? Multiple Actions(-5)?|0} [Modifiers] - ?{DoD|0} [DoD]]]}} {{--------=--------}} {{Critical=20+}} {{Full=11-19}} {{Partial=6-10}} {{Failure=1-5}} {{Mishap=0 or below}}" />
                </div>

                <div class="flex">
                    <label>CON</label>
                    <input type="number" name="attr_constitution" value="0" />
                    <button type="roll" name="roll_constitution" value="&{template:default} {{name=Attribute | Constitution}} {{Check Result=[[1d20 + (@{Constitution}*2) [Attribute] + ?{Modifiers? Multiple Actions(-5)?|0} [Modifiers] - ?{DoD|0} [DoD]]]}} {{--------=--------}} {{Critical=20+}} {{Full=11-19}} {{Partial=6-10}} {{Failure=1-5}} {{Mishap=0 or below}}" />
                </div>

                <div class="flex">
                    <label>SPD</label>
                    <input type="number" name="attr_speed" value="0" />
                    <button type="roll" name="roll_speed" value="&{template:default} {{name=Attribute | Speed}} {{Check Result=[[1d20 + (@{Speed}*2) [Attribute] + ?{Modifiers? Multiple Actions(-5)?|0} [Modifiers] - ?{DoD|0} [DoD]]]}} {{--------=--------}} {{Critical=20+}} {{Full=11-19}} {{Partial=6-10}} {{Failure=1-5}} {{Mishap=0 or below}}" />
                </div>

                <div class="flex">
                    <label>CCR</label>
                    <input type="number" name="attr_combatrating" value="0" />
                </div>

                <div class="flex">
                    <label>RCR</label>
                    <input type="number" name="attr_rangedcr" value="0" />
                </div>

                <div class="flex">
                    <label>MMR</label>
                    <input type="number" name="attr_magicrating" value="0" />
                </div>
            </div>
        </div>

        <div class="grid col1">
            
            <label>Appearance</label>
            <textarea name="attr_appearance"></textarea>

            <label>Paths Followed</label>
            <textarea name="attr_paths"></textarea>
        </div>
    </div>

    <div class="grid col1">
        <div class="grid col5">
            <label>Hit Points</label>
            

            <label>Movement Rate</label>
           

            <label>Protection Rating</label>
            

            <label>Current Lethal Damage</label>
            

            <label>Current Subdual Damage</label>
            
        </div>
        <div class="grid col5">
            <input type="number" name="attr_charhp" value="0" />
            <input type="number" name="attr_movementrate" value="50" />
            <input type="number" name="attr_charpr" value="0" />
            <input type="number" name="attr_charlethal" value="0" />
            <input type="number" name="attr_charsubdual" value="0" />
        </div>
    </div>

    <div class="grid special-buttons">
        <h2>Attribute Actions</h2>
        <div class="grid col4-buttons">
            <button type="roll" name="roll_initiative" class="initiative" value="&{template:custom} {{title=Initiative}} {{subtitle=@{charactername}}} {{Initiative Total=[[1d20 + (@{speed}*2) [Attribute] + ?{Modifiers?|0} [Modifiers] &{tracker}]]}}" />
            <button type="roll" name="roll_critical" class="critical" value="&{template:custom} {{critroll=true}} {{title=Critical Hit}} {{subtitle=@{charactername}}} {{Result=[[1d20 + (@{constitution}*2) [Attribute] + ?{Modifiers?|0} [Modifiers] - ?{DR or Attack|0} [Damage]]]}}" />
            <button type="roll" name="roll_chase" class="chase" value="&{template:custom} {{pursuitroll=true}} {{title=Pursuit}} {{subtitle=@{charactername}}} {{Result=[[1d20 + (@{speed}*2) [Attribute] + ?{Modifiers?|0} [Modifiers]]]}} {{Movement Rate=@{movementrate} ft.}}" />
            <button type="roll" name="roll_reaction" class="reaction" value="&{template:custom} {{reactionroll=true}} {{title=Reaction}} {{subtitle=@{charactername}}} {{Result=[[1d20 + (@{charisma}*2) [Attribute] + ?{Modifiers?|0} [Modifiers]]]}}" />
        </div>
    </div>

    <div class="grid special-buttons">
        <h2>Combat Tactics</h2>
        <div class="grid col4-buttons">
            <input type="hidden" name="attr_charEvade" value="0" />
            <input type="hidden" name="attr_charAcrobatics" value="0" />
            <input type="hidden" name="attr_charGuard" value="0" />
            <input type="hidden" name="attr_charBrawl" value="0" />
            <button type="roll" name="roll_grappleatk" class="grappleatk" value="&{template:custom} {{grappleatkroll=true}} {{title=Grapple Attack}} {{subtitle=@{charactername}}} {{Result=[[1d20 + (@{combatrating}) [Attribute] + @{charBrawl} [Skill] + ?{Modifiers?|0} [Modifiers] - ?{DoD|0} [DoD] ]]}}" />
            <button type="roll" name="roll_grappleesc" class="grappleesc" value="&{template:custom} {{grappleescroll=true}} {{title=Grapple Escape}} {{subtitle=@{charactername}}} {{Result=[[1d20 + (@{combatrating}) [Attribute] + @{charBrawl} [Skill] + ?{Modifiers?|0} [Modifiers] - ?{DoD|0} [DoD] ]]}}" />
            <button type="roll" name="roll_guard" class="parryguard" value="&{template:custom} {{parryroll=true}} {{title=Guard Parry}} {{subtitle=@{charactername}}} {{Result=[[1d20 + (@{perception}) [Attribute] + @{charGuard} [Skill] + ?{Modifiers?|0} [Modifiers] - ?{DoD|0} [DoD] ]]}}" />
            <button type="roll" name="roll_brawlparry" class="parrybrawl" value="&{template:custom} {{parryroll=true}} {{title=Brawl Parry}} {{subtitle=@{charactername}}} {{Result=[[1d20 + (@{dexterity}) [Attribute] + @{charBrawl} [Skill] + ?{Modifiers?|0} [Modifiers] - ?{DoD|0} [DoD] ]]}}" />
            <button type="roll" name="roll_evade" class="dodgeevade" value="&{template:custom} {{dodgeroll=true}} {{title=Evade Dodge}} {{subtitle=@{charactername}}} {{Result=[[1d20 + (@{dexterity}) [Attribute] + @{charEvade} [Skill] + ?{Modifiers?|0} [Modifiers] + ?{DoD|0} [DoD] ]]}}" />
            <button type="roll" name="roll_acrododge" class="dodgeacro" value="&{template:custom} {{dodgeroll=true}} {{title=Acrobatics Dodge}} {{subtitle=@{charactername}}} {{Result=[[1d20 + (@{dexterity}) [Attribute] + @{charAcrobatics} - 5 [Skill] + ?{Modifiers?|0} [Modifiers] - ?{DoD|0} [DoD] ]]}}" />
            <button type="roll" name="roll_dexdodge" class="dodgedex" value="&{template:custom} {{dodgeroll=true}} {{title=Dex Dodge}} {{subtitle=@{charactername}}} {{Result=[[1d20 + (@{dexterity}*2) [Attribute] + ?{Modifiers?|0} [Modifiers] - ?{DoD|0} [DoD] ]]}}" />
            <button type="roll" name="roll_crdodge" class="dodgecr" value="&{template:custom} {{dodgeroll=true}} {{title=CR Dodge}} {{subtitle=@{charactername}}} {{Result=[[1d20 + (@{combatrating}) [Attribute] + ?{Modifiers?|0} [Modifiers] - ?{DoD|0} [DoD] ]]}}" />
        </div>
    </div>

    <div class="grid col1-skills">
        <h2>Skills</h2>
        <div class="grid col5-skills">
            <label>Name</label>

            <label>Subskill</label>

            <label>Stat</label>

            <label>Rank</label>

            <label>Inherent Mod</label>

            <label>Item Mod</label>
        </div>
        <fieldset class="repeating_skills">
            <div class="grid col5-skills">
                <select name="attr_skillname">
                    <option value="">Choose</option>
                    <option disabled style="background:gray;font-weight:bold;color:white;">&nbsp;&nbsp;&nbsp;&nbsp; COMMON</option>
                    <option value="climbing">Climbing</option>
                    <option value="conveyance">Conveyance</option>
                    <option value="cook">Cook</option>
                    <option value="fashion">Fashion</option>
                    <option value="haggle">Haggle</option>
                    <option value="ride">Ride</option>
                    <option value="signal">Signal</option>
                    <option value="swim">Swim</option>
                    <option disabled style="background:gray;font-weight:bold;color:white;">&nbsp;&nbsp;&nbsp;&nbsp; LANGUAGE</option>
                    <option value="hightalislan">High Talislan</option>
                    <option value="lowtalislan">Low Talislan</option>
                    <option value="archaen">Archaen</option>
                    <option value="bodorian">Bodorian</option>
                    <option value="chanan">Chanan</option>
                    <option value="elder">Elder</option>
                    <option value="nomadic">Nomadic</option>
                    <option value="northron">Northron</option>
                    <option value="phaedran">Phaedran</option>
                    <option value="quan">Quan</option>
                    <option value="racialtongues">Racial Tongues</option>
                    <option value="rajanin">Rajanin</option>
                    <option value="sarisa">Sarisa</option>
                    <option value="seanomad">Sea Nomad</option>
                    <option value="sign">Sign</option>
                    <option value="thaecian">Thaecian</option>
                    <option value="xambrian">Xambrian</option>
                    <option disabled style="background:gray;font-weight:bold;color:white;">&nbsp;&nbsp;&nbsp;&nbsp; COMBAT</option>
                    <option value="artillerist">Artillerist</option>
                    <option value="assassinate">Assassinate</option>
                    <option value="brawling">Brawling</option>
                    <option value="command">Command</option>
                    <option value="evade">Evade</option>
                    <option value="guard">Guard</option>
                    <option value="tactics">Tactics</option>
                    <option value="bow">Bow</option>
                    <option value="crossbow">Crossbow</option>
                    <option value="spring">Spring</option>
                    <option value="thrown">Thrown</option>
                    <option value="smallblades">Small Blades</option>
                    <option value="largeblades">Large Blades</option>
                    <option value="hafted">Hafted</option>
                    <option value="2hblades">2H Blades</option>
                    <option value="2hhafted">2H Hafted</option>
                    <option value="flails">Flails</option>
                    <option value="polearms">Polearms</option>
                    <option disabled style="background:gray;font-weight:bold;color:white;">&nbsp;&nbsp;&nbsp;&nbsp; PERFORMING</option>
                    <option value="acrobatics">Acrobatics</option>
                    <option value="acting">Acting</option>
                    <option value="art">Art</option>
                    <option value="dance">Dance</option>
                    <option value="legerdemain">Legerdemain</option>
                    <option value="mimicry">Mimicry</option>
                    <option value="oratory">Oratory</option>
                    <option value="song">Song</option>
                    <option disabled style="background:gray;font-weight:bold;color:white;">&nbsp;&nbsp;&nbsp;&nbsp; SCHOLARLY</option>
                    <option value="analysis">Analysis</option>
                    <option value="anatomy">Anatomy</option>
                    <option value="antiquarian">Antiquarian</option>
                    <option value="arcanelore">Arcane Lore</option>
                    <option value="astrology">Astrology</option>
                    <option value="cartography">Cartography</option>
                    <option value="cultures">Cultures</option>
                    <option value="cryptography">Cryptography</option>
                    <option value="doctrines">Doctrines</option>
                    <option value="engineer">Engineer</option>
                    <option value="gamecraft">Gamecraft</option>
                    <option value="geography">Geography</option>
                    <option value="history">History</option>
                    <option value="linguistics">Linguistics</option>
                    <option value="litigator">Litigator</option>
                    <option value="meditation">Meditation</option>
                    <option value="naturalism">Naturalism</option>
                    <option disabled style="background:gray;font-weight:bold;color:white;">&nbsp;&nbsp;&nbsp;&nbsp; THIEVING</option>
                    <option value="bribe">Bribe</option>
                    <option value="coerce">Coerce</option>
                    <option value="deception">Deception</option>
                    <option value="disabledevice">Disable Device</option>
                    <option value="espionage">Espionage</option>
                    <option value="forgery">Forgery</option>
                    <option value="gambling">Gambling</option>
                    <option value="interrogate">Interrogate</option>
                    <option value="legerdemain">Legerdemain</option>
                    <option value="lipreading">Lip-Reading</option>
                    <option value="sabotage">Sabotage</option>
                    <option value="seduce">Seduce</option>
                    <option value="stealth">Stealth</option>
                    <option value="streetwise">Streetwise</option>
                    <option value="torture">Torture</option>
                    <option value="traps">Traps</option>
                    <option value="underworld">Underworld</option>
                    <option disabled style="background:gray;font-weight:bold;color:white;">&nbsp;&nbsp;&nbsp;&nbsp; TRADE</option>
                    <option value="administrator">Administrator</option>
                    <option value="agriculture">Agriculture</option>
                    <option value="animalhandler">Animal Handler</option>
                    <option value="appraiser">Appraiser</option>
                    <option value="caravanmaster">Caravan Master</option>
                    <option value="fishing">Fishing</option>
                    <option value="handicraft">Handicraft</option>
                    <option value="healer">Healer</option>
                    <option value="laborer">Laborer</option>
                    <option value="livestock">Livestock</option>
                    <option value="merchant">Merchant</option>
                    <option value="mining">Mining</option>
                    <option value="pilot">Pilot</option>
                    <option value="salvager">Salvager</option>
                    <option disabled style="background:gray;font-weight:bold;color:white;">&nbsp;&nbsp;&nbsp;&nbsp; WILDERNESS</option>
                    <option value="guide">Guide</option>
                    <option value="herblore">Herb Lore</option>
                    <option value="mimicry">Mimicry</option>
                    <option value="scout">Scout</option>
                    <option value="tracking">Tracking</option>
                    <option value="traps">Traps</option>
                    <option value="survival">Survival</option>
                    <option disabled style="background:gray;font-weight:bold;color:white;">&nbsp;&nbsp;&nbsp;&nbsp; MAGICAL</option>
                    <option value="alchemy">Alchemy</option>
                    <option value="botanomancy">Botanomancy</option>
                    <option value="modeattack">Mode (attack)</option>
                    <option value="modeconjuration">Mode (conjuration)</option>
                    <option value="modedivination">Mode (divination)</option>
                    <option value="modeenchantment">Mode (enchantment)</option>
                    <option value="modeinfluence">Mode (influence)</option>
                    <option value="modeillusion">Mode (illusion)</option>
                    <option value="modemove">Mode (move)</option>
                    <option value="modetransmutation">Mode (transmutation)</option>
                    <option value="modeward">Mode (ward)</option>
                    <option value="talismancy">Talismancy</option>
                    <option value="technomancy">Technomancy</option>
                    <option value="thamaturgy">Thamaturgy</option>
                    <option disabled style="background:gray;font-weight:bold;color:white;">&nbsp;&nbsp;&nbsp;&nbsp; SPECIAL</option>
                    <option value="beastlore">Beast Lore</option>
                    <option value="dispelmagic">Dispel Magic</option>
                    <option value="influenceplants">Influence Plants</option>
                    <option value="naturaltelempathy">Natural Telempathy</option>
                    <option value="rhabdomancy">Rhabdomancy</option>
                    <option value="shapechange">Shapechange</option>
                </select>

                <input type="text" name="attr_subskill" value="" />

                <input type="text" list="abilityScores" name="attr_abilityscore">
                <datalist id="abilityScores">Attribute
                    <option value="@{Intelligence}">INT</option>
                    <option value="@(Perception)">PER</option>
                    <option value="@{Will}">WIL</option>
                    <option value="@{Charisma}">CHA</option>
                    <option value="@{Strength}">STR</option>
                    <option value="@{Dexterity}">DEX</option>
                    <option value="@{Constitution}">CON</option>
                    <option value="@{Speed}">SPD</option>
                    <option value="@{combatrating}">CCR</option>
                    <option value="@{rangedcr}">RCR</option>
                    <option value="@{magicrating}">MMR</option>
                </datalist>

                <input type="number" name="attr_skillrank" value="0" />

                <input type="number" name="attr_inherentmod" value="0" />

                <input type="number" name="attr_itemmod" value="0" />

                <button type="roll" name="roll_skill" value="&{template:custom} {{standardroll=true}} {{title=Skill | @{skillname}}} {{subtitle=@{charactername}}} {{Result=[[1d20 + (@{abilityscore}) [Attribute] + @{skillrank} [Skill] + @{inherentmod} [Inherent Mod] + @{itemmod} [Item Mod] + ?{Modifiers? Multiple Actions(-5)?|0} [Modifiers] - ?{DoD|0} [DoD]]]}}" />
            </div>
        </fieldset>
    </div>

    <div class="grid col1-quirks">
        <h2>Quirks</h2>
        <div class="grid col3">
            <label>Quirk</label>

            <label>Description</label>

            <label>Type</label>
        </div>
        <fieldset class="repeating_abilities">
            <div class="grid col3">
                <input type="text" name="attr_quirkname" value="" />

                <input type="text" name="attr_quirkdesc" value="" />

                <select name="attr_quirktype">
                    <option value="">Choose</option>
                    <option value="positive">Positive</option>
                    <option value="negative">Negative</option>
                </select>
            </div>
        </fieldset>
    </div>

    <div class="grid col1-weapons">
        <h2>Combat Weapons</h2>
        <div class="grid col6-weapons">
            <label>Name</label>

            <label>Skill Type</label>

            <label>Stat</label>

            <label>Rank</label>

            <label>Item Mod</label>

            <label>DR</label>
        </div>
        <fieldset class="repeating_weapons">
            <div class="grid col6-weapons">
                <input type="text" name="attr_weaponname" value="" />

                <select name="attr_skilltype">
                    <option value="">Choose</option>
                    <option value="bow">Bow</option>
                    <option value="crossbow">Crossbow</option>
                    <option value="spring">Spring</option>
                    <option value="thrown">Thrown</option>
                    <option value="smallblades">Small Blades</option>
                    <option value="largeblades">Large Blades</option>
                    <option value="hafted">Hafted</option>
                    <option value="2hblades">2H Blades</option>
                    <option value="2hhafted">2H Hafted</option>
                    <option value="flails">Flails</option>
                    <option value="polearms">Polearms</option>
                    <option value="brawling">Brawling</option>
                    <option value="assassinate">Assassinate</option>
                </select>

                <input type="text" list="abilityScores" name="attr_weaponstat">
                <datalist id="abilityScores">Attribute
                    <option value="@{combatrating}">CCR</option>
                    <option value="@{rangedcr}">RCR</option>
                </datalist>

                <input type="number" name="attr_weaponskillrank" value="0" />

                <input type="number" name="attr_weaponitemmod" value="0" />

                <input type="number" name="attr_weapondr" value="0" />

                <button type="roll" name="roll_attack" class="weapatk" value="&{template:custom} {{attackroll=true}} {{title=Attack | @{weaponname}}} {{subtitle=@{charactername}}} {{Result=[[1d20 + @{weaponstat} [Attribute] + @{weaponskillrank} [Skill] + @{weaponitemmod} [Item Mod] + ?{Modifiers? Multiple Actions(-5)?|0} [Modifiers] - ?{DoD|0} [DoD]]]}} {{Base Damage=[[@{weapondr}]]}} {{Strength Damage=[[@{strength}]]}}" />
            
                <button type="roll" name="roll_parry" class="weappar" value="&{template:custom} {{parryroll=true}} {{title=Parry | @{weaponname}}} {{subtitle=@{charactername}}} {{Result=[[1d20 + @{weaponstat} [Attribute] + @{weaponskillrank} [Skill] + @{weaponitemmod} [Item Mod] + ?{Modifiers? Multiple Actions(-5)?|0} [Modifiers] - ?{DoD|0} [DoD]]]}}" />
            </div>
        </fieldset>
    </div>

    <div class="grid col1-equipment">
        <h2>Equipment</h2>
        <div class="grid col6-equipment">
            <label>Name</label>

            <label>Type</label>

            <label>Min STR</label>

            <label>DR/PR</label>

            <label>Max DR</label>

            <label>Range</label>
        </div>
        <fieldset class="repeating_equipment">
            <div class="grid col6-equipment">
                <input type="text" name="attr_equipname" value="" />

                <select name="attr_equiptype">
                    <option value="">Choose</option>
                    <option value="general">General</option>
                    <option value="parry">Parry</option>
                    <option value="armour">Armour</option>
                    <option value="bow">Bow</option>
                    <option value="crossbow">Crossbow</option>
                    <option value="spring">Spring</option>
                    <option value="thrown">Thrown</option>
                    <option value="smallblades">Small Blades</option>
                    <option value="largeblades">Large Blades</option>
                    <option value="hafted">Hafted</option>
                    <option value="2hblades">2H Blades</option>
                    <option value="2hhafted">2H Hafted</option>skillname
                    <option value="flails">Flails</option>
                    <option value="polearms">Polearms</option>
                    <option value="brawling">Brawling</option>
                    <option value="assassinate">Assassinate</option>
                    <option value="unique">Special Equipment</option>
                </select>

                <input type="number" name="attr_minstr" value="" />

                <input type="number" name="attr_drpr" value="" />

                <input type="number" name="attr_maxdr" value="" />

                <input type="number" name="attr_range" value="" />
            </div>
        </fieldset>
    </div>
</div>

<rolltemplate class="sheet-rolltemplate-custom">
    <div class="sheet-container sheet-color-{{color}}">
        <div class="sheet-header">
            {{#title}}<div class="sheet-title">{{title}}</div>{{/title}}
            {{#subtitle}}<div class="sheet-subtitle">{{subtitle}}</div>{{/subtitle}}
        </div>
        <div class="sheet-content">
            {{#allprops() title subtitle desc color standardroll attackroll critroll pursuitroll reactionroll dodgeroll parryroll grappleatkroll grappleescroll}}
            <div class="sheet-key">{{key}}</div>
            <div class="sheet-value">{{value}}</div>
            {{/allprops() title subtitle desc color standardroll attackroll critroll pursuitroll reactionroll dodgeroll parryroll grappleatkroll grappleescroll}}
            {{#standardroll}}
                {{#Result}}<div class="sheet-result">
                    {{#rollLess() Result 1}}<span class="sheet-mishap">Mishap!</span>{{/rollLess() Result 1}}
                    {{#rollBetween() Result 1 5}}<span class="sheet-failure">Failure</span>{{/rollBetween() Result 1 5}}
                    {{#rollBetween() Result 6 10}}<span class="sheet-partialsuccess">Partial Success</span>{{/rollBetween() Result 6 10}}
                    {{#rollBetween() Result 11 19}}<span class="sheet-fullsuccess">Full Success</span>{{/rollBetween() Result 11 19}}
                    {{#rollGreater() Result 19}}<span class="sheet-critical">Critical!</span>{{/rollGreater() Result 19}}
                </div>{{/Result}}
            {{/standardroll}}
            {{^standardroll}}
                {{#attackroll}}
                {{#Result}}<div class="sheet-result">
                    {{#rollLess() Result 1}}<span class="sheet-mishap">Mishap!</span>{{/rollLess() Result 1}}
                    {{#rollBetween() Result 1 5}}<span class="sheet-failure">Failure!</span>{{/rollBetween() Result 1 5}}
                    {{#rollBetween() Result 6 10}}<span class="sheet-partialsuccess">Partial Success - half damage (rounded up)</span>{{/rollBetween() Result 6 10}}
                    {{#rollBetween() Result 11 19}}<span class="sheet-fullsuccess">Full Success!</span>{{/rollBetween() Result 11 19}}
                    {{#rollGreater() Result 19}}<span class="sheet-critical">Critical! Opponent must roll Critical Hit</span>{{/rollGreater() Result 19}}
                </div>{{/Result}}
                {{/attackroll}}
                {{#critroll}}
                {{#Result}}<div class="sheet-result">
                    {{#rollLess() Result 1}}<span class="sheet-mishap">Mishap! You are unconscious</span>{{/rollLess() Result 1}}
                    {{#rollBetween() Result 1 5}}<span class="sheet-failure">Failure! You are unconscious</span>{{/rollBetween() Result 1 5}}
                    {{#rollBetween() Result 6 10}}<span class="sheet-partialsuccess">Partial Success - minus 5 to all rolls</span>{{/rollBetween() Result 6 10}}
                    {{#rollBetween() Result 11 19}}<span class="sheet-fullsuccess">Full Success! You are unhindered</span>{{/rollBetween() Result 11 19}}
                    {{#rollGreater() Result 19}}<span class="sheet-critical">Critical! You are unhindered</span>{{/rollGreater() Result 19}}
                </div>{{/Result}}
                {{/critroll}}
                {{#pursuitroll}}
                {{#Result}}<div class="sheet-result">
                    {{#rollLess() Result 1}}<span class="sheet-mishap">Mishap! You fall and injure yourself, you cannot continue</span>{{/rollLess() Result 1}}
                    {{#rollBetween() Result 1 5}}<span class="sheet-failure">Failure! You stumble and fall, try again next round</span>{{/rollBetween() Result 1 5}}
                    {{#rollBetween() Result 6 10}}<span class="sheet-partialsuccess">Partial Success - you travel half your Movement Rate</span>{{/rollBetween() Result 6 10}}
                    {{#rollBetween() Result 11 19}}<span class="sheet-fullsuccess">Full Success! You travel your Movement Rate</span>{{/rollBetween() Result 11 19}}
                    {{#rollGreater() Result 19}}<span class="sheet-critical">Critical! Increase Movement Rate by 50ft</span>{{/rollGreater() Result 19}}
                </div>{{/Result}}
                {{/pursuitroll}}
                {{#reactionroll}}
                {{#Result}}<div class="sheet-result">
                    {{#rollLess() Result 1}}<span class="sheet-mishap">Mishap! They will slander or mug you</span>{{/rollLess() Result 1}}
                    {{#rollBetween() Result 1 5}}<span class="sheet-failure">Failure! You have been ignored</span>{{/rollBetween() Result 1 5}}
                    {{#rollBetween() Result 6 10}}<span class="sheet-partialsuccess">Partial Success - you will need to pay a bribe</span>{{/rollBetween() Result 6 10}}
                    {{#rollBetween() Result 11 19}}<span class="sheet-fullsuccess">Full Success! You get the info or aid</span>{{/rollBetween() Result 11 19}}
                    {{#rollGreater() Result 19}}<span class="sheet-critical">Critical! You get additional info or aid</span>{{/rollGreater() Result 19}}
                </div>{{/Result}}
                {{/reactionroll}}
                {{#dodgeroll}}
                {{#Result}}<div class="sheet-result">
                    {{#rollLess() Result 1}}<span class="sheet-mishap">Mishap! Off balance, opponent gets +2 to hit</span>{{/rollLess() Result 1}}
                    {{#rollBetween() Result 1 5}}<span class="sheet-failure">Failure! Attacker rolls to hit</span>{{/rollBetween() Result 1 5}}
                    {{#rollBetween() Result 6 10}}<span class="sheet-partialsuccess">Partial Success - attacker rolls to hit</span>{{/rollBetween() Result 6 10}}
                    {{#rollBetween() Result 11 19}}<span class="sheet-fullsuccess">Full Success! Attack is dodged</span>{{/rollBetween() Result 11 19}}
                    {{#rollGreater() Result 19}}<span class="sheet-critical">Critical! Attack is dodged and you get +2 to attack next round</span>{{/rollGreater() Result 19}}
                </div>{{/Result}}
                {{/dodgeroll}}
                {{#parryroll}}
                {{#Result}}<div class="sheet-result">
                    {{#rollLess() Result 1}}<span class="sheet-mishap">Mishap! Off balance, -2 to next action</span>{{/rollLess() Result 1}}
                    {{#rollBetween() Result 1 5}}<span class="sheet-failure">Failure! Attacker rolls to hit</span>{{/rollBetween() Result 1 5}}
                    {{#rollBetween() Result 6 10}}<span class="sheet-partialsuccess">Partial Success - attacker rolls to hit</span>{{/rollBetween() Result 6 10}}
                    {{#rollBetween() Result 11 19}}<span class="sheet-fullsuccess">Full Success! Attack is parried</span>{{/rollBetween() Result 11 19}}
                    {{#rollGreater() Result 19}}<span class="sheet-critical">Critical! Attack is parried</span>{{/rollGreater() Result 19}}
                </div>{{/Result}}
                {{/parryroll}}
                {{#grappleatkroll}}
                {{#Result}}<div class="sheet-result">
                    {{#rollLess() Result 1}}<span class="sheet-mishap">Mishap! Opponent recieves +5 to next attack</span>{{/rollLess() Result 1}}
                    {{#rollBetween() Result 1 5}}<span class="sheet-failure">Failure! Failed to grab the defender</span>{{/rollBetween() Result 1 5}}
                    {{#rollBetween() Result 6 10}}<span class="sheet-partialsuccess">Partial Success - no leverage, cannot choke or throw and defender has +5 to escape</span>{{/rollBetween() Result 6 10}}
                    {{#rollBetween() Result 11 19}}<span class="sheet-fullsuccess">Full Success! Hold achieved, can choke or throw with next action</span>{{/rollBetween() Result 11 19}}
                    {{#rollGreater() Result 19}}<span class="sheet-critical">Critical! Strong hold, defender has -5 to escape</span>{{/rollGreater() Result 19}}
                </div>{{/Result}}
                {{/grappleatkroll}}
                {{#grappleescroll}}
                {{#Result}}<div class="sheet-result">
                    {{#rollLess() Result 1}}<span class="sheet-mishap">Mishap! You have -5 to the next attempt to escape</span>{{/rollLess() Result 1}}
                    {{#rollBetween() Result 1 5}}<span class="sheet-failure">Failure! You remain in the hold</span>{{/rollBetween() Result 1 5}}
                    {{#rollBetween() Result 6 10}}<span class="sheet-partialsuccess">Partial Success - you loosen the hold and have +5 to your next escape</span>{{/rollBetween() Result 6 10}}
                    {{#rollBetween() Result 11 19}}<span class="sheet-fullsuccess">Full Success! You escape the hold</span>{{/rollBetween() Result 11 19}}
                    {{#rollGreater() Result 19}}<span class="sheet-critical">Critical! Perfect reversal, make an immediate grapple attack or move away</span>{{/rollGreater() Result 19}}
                </div>{{/Result}}
                {{/grappleescroll}}
            {{/standardroll}}
            {{#desc}}<div class="sheet-desc">{{desc}}</div>{{/desc}}
        </div>
    </div>
</rolltemplate>

<script type="text/worker">

    on("change:repeating_skills:skillrank", function(eventinfo) {
        getAttrs(["repeating_skills_skillname"], function(values) {
            let updateValue = 0;
            if(values.repeating_skills_skillname == "evade") {
                updateValue = eventinfo.newValue;
                setAttrs({
                    "charEvade": updateValue
                });
            }
            else if(values.repeating_skills_skillname == "acrobatics") {
                updateValue = eventinfo.newValue;
                setAttrs({
                    "charAcrobatics": updateValue
                });
            }
            else if(values.repeating_skills_skillname == "guard") {
                updateValue = eventinfo.newValue;
                setAttrs({
                    "charGuard": updateValue
                });
            }
            else if(values.repeating_skills_skillname == "brawling") {
                updateValue = eventinfo.newValue;
                setAttrs({
                    "charBrawl": updateValue
                });
            }            
        });
    });

    on("change:repeating_weapons:skilltype", function(eventinfo) {

        const skilltype = eventinfo.newValue;
        console.log(skilltype);
        const rowid = eventinfo.sourceAttribute;
        console.log(rowid);
        let attrlength = rowid.length;
        attrlength = attrlength - 9;
        let updateid = rowid.substr(0,attrlength);
        const weapskillrank = updateid.concat("weaponskillrank");
        console.log(weapskillrank);

        setAttrs({
            repeating_weapons_weaponskillrank: 0
        });

        getSectionIDs('skills',function(idarray) {
            const skillnames = [];
            idarray.forEach(id => skillnames.push(`repeating_skills_${id}_skillname`));
            console.log(skillnames);

            getAttrs(skillnames, function(values) {
                console.log(values);
                console.log(eventinfo.newValue);
                Object.keys(values).forEach(key => {
                    console.log(key + ", " + values[key]);
                    console.log(skilltype);
                    if(values[key] == skilltype) {
                        const skillid = key;
                        console.log(skillid);
                        let length = skillid.length;
                        length = length - 9;
                        let repeatid = skillid.substr(0,length);
                        const skillrank = repeatid.concat("skillrank");
                        console.log(skillrank);
                        getAttrs([skillrank], function(values) {
                            console.log(values);
                            console.log(values[skillrank]);
                            setAttrs({
                                repeating_weapons_weaponskillrank: values[skillrank]
                            });
                        });
                    }
                });
            });
        });
    
    });
    
</script>